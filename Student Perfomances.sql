--Condition
--Create a request to obtain information about student performance. 
--The table should contain information only based on the test results.
--exams in the disciplines provided for by the curriculum for the specialty in which the student is studying.

WITH SRC AS (
    SELECT ROW_NUMBER() OVER (PARTITION BY ?.??????? ORDER BY ???????) AS R1,
           ROW_NUMBER() OVER (PARTITION BY ?.???????,?.???????? ORDER BY ???????) AS R2,
           ?.???????, ??.??????,??.????, ?.???????? 
    FROM ???????? ?
    LEFT JOIN ???????????? ?? ON ?.?????_????????=??.?????_????????
    LEFT JOIN ?????????? ? ON ?.?????_??????????=??.?????_??????????
    WHERE (?.?????_????????, ?.?????_??????????) IN 
                (SELECT ?.?????_????????, ?.?????_??????????
                 FROM ???????? ?
                 LEFT JOIN ?????? ? ON ?.?????_??????=?.?????_??????
                 LEFT JOIN ???????_????? ? ON ?.???_?????????????=?.???_?????????????) 
           OR ?.?????_?????????? IS NULL
)
SELECT (CASE WHEN R1 = 1 THEN ??????? ELSE ' ' END) AS "???",
       (CASE WHEN ???? IS NULL THEN '???????? ?? ??????' 
             ELSE ???????? END) AS "??????????",
        NVL(TO_CHAR(??????), ' ') AS "??????",
        NVL(TO_CHAR(????, 'DD.MM.YY'), ' ') AS "????",
        (CASE WHEN R2 > 1 THEN '?????????' ELSE ' ' END) "??????????"
FROM SRC;
